@startuml sequence
title Diagrama de Sequência - Visualização de Consumo em Tempo Real

actor Usuario as "Usuário Residencial"
participant "Frontend Web\n(Vue.js)" as Frontend
participant "API Backend\n(Go)" as Backend
participant "Broker MQTT\n(Mosquitto/EMQX)" as Broker
participant "Dispositivo IoT\n(Tomada Inteligente)" as Dispositivo
participant "Banco de Dados\n(InfluxDB/PostgreSQL)" as DB

== Coleta de Dados ==
Dispositivo -> Broker : Publica telemetria via MQTT
Broker -> Backend : Encaminha dados em tempo real
Backend -> DB : Armazena dados (InfluxDB/PostgreSQL)

== Visualização pelo Usuário ==
Usuario -> Frontend : Acessa dashboard
Frontend -> Backend : Solicita dados recentes (REST API)
Backend -> DB : Consulta dados de telemetria
DB --> Backend : Retorna dados consultados
Backend --> Frontend : Retorna JSON com os dados
Frontend --> Usuario : Exibe gráfico em tempo real

@enduml
